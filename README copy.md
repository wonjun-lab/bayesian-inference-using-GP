# PyMC Examples

PyMCλ¥Ό ν™μ©ν• Bayesian μ¶”λ΅ κ³Ό Gaussian Process λ¨λΈλ§ μμ  μ €μ¥μ†λ‹¤.

## π“‹ λ©μ°¨

- [ν™κ²½ μ„¤μΉ](#ν™κ²½-μ„¤μΉ)
- [ν”„λ΅μ νΈ κµ¬μ΅°](#ν”„λ΅μ νΈ-κµ¬μ΅°)
- [μμ  μ†κ°](#μμ -μ†κ°)
- [κΈ°μ μ  λ°°κ²½](#κΈ°μ μ -λ°°κ²½)
- [μ‚¬μ©λ²•](#μ‚¬μ©λ²•)
- [μ£Όμ” κ°λ… μ„¤λ…](#μ£Όμ”-κ°λ…-μ„¤λ…)
- [μμ΅΄μ„±](#μμ΅΄μ„±)

## π€ ν™κ²½ μ„¤μΉ

### 1. μ €μ¥μ† ν΄λ΅ 
```bash
git clone <repository-url>
cd pymc-examples
```

### 2. uv μ„¤μΉ

μ΄ ν”„λ΅μ νΈλ” `uv`λ¥Ό μ‚¬μ©ν•μ—¬ ν¨ν‚¤μ§€ μμ΅΄μ„±μ„ κ΄€λ¦¬ν•λ‹¤. `uv`λ” Python ν¨ν‚¤μ§€ μ„¤μΉμ™€ κ°€μƒν™κ²½ κ΄€λ¦¬λ¥Ό λΉ λ¥΄κ³  ν¨μ¨μ μΌλ΅ μ²λ¦¬ν•λ” λ„κµ¬λ‹¤.

#### Linux/Macμ—μ„ uv μ„¤μΉ
```bash
curl -LsSf https://astral.sh/uv/install.sh | sh
```

#### Windowsμ—μ„ uv μ„¤μΉ
Windowsμ—μ„λ” PowerShellμ„ κ΄€λ¦¬μ κ¶ν•μΌλ΅ μ‹¤ν–‰ν• ν›„ λ‹¤μ λ…λ Ήμ–΄λ¥Ό μ…λ ¥ν•λ‹¤:

```powershell
powershell -ExecutionPolicy ByPass -c "irm https://astral.sh/uv/install.ps1 | iex"
```

λλ” Windows ν¨ν‚¤μ§€ κ΄€λ¦¬μ `winget`μ„ μ‚¬μ©ν•  μλ„ μλ‹¤:
```powershell
winget install --id=astral-sh.uv -e
```

μ„¤μΉ ν›„ ν„°λ―Έλ„μ„ μ¬μ‹μ‘ν•μ—¬ `uv` λ…λ Ήμ–΄λ¥Ό μ‚¬μ©ν•  μ μλ”μ§€ ν™•μΈν•λ‹¤:
```bash
uv --version
```

### 3. ν”„λ΅μ νΈ μμ΅΄μ„± μ„¤μΉ

ν”„λ΅μ νΈ λ””λ ‰ν† λ¦¬μ—μ„ λ‹¤μ λ…λ Ήμ–΄λ¥Ό μ‹¤ν–‰ν•μ—¬ ν•„μ”ν• λ¨λ“  ν¨ν‚¤μ§€λ¥Ό μ„¤μΉν•κ³  κ°€μƒν™κ²½μ„ μƒμ„±ν•λ‹¤:

```bash
uv sync
```

`uv sync` λ…λ Ήμ–΄λ” λ‹¤μ μ‘μ—…μ„ μλ™μΌλ΅ μν–‰ν•λ‹¤:
- `pyproject.toml` νμΌμ„ μ½μ–΄ ν•„μ”ν• ν¨ν‚¤μ§€ λ©λ΅ ν™•μΈ
- `.venv` λ””λ ‰ν† λ¦¬μ— κ°€μƒν™κ²½ μƒμ„± (μ—†λ” κ²½μ°)
- λ¨λ“  μμ΅΄μ„± ν¨ν‚¤μ§€λ¥Ό κ°€μƒν™κ²½μ— μ„¤μΉ
- ν¨ν‚¤μ§€ λ²„μ „μ„ `uv.lock` νμΌμ— κ³ μ •

### 4. κ°€μƒν™κ²½ ν™μ„±ν™”

μ„¤μΉκ°€ μ™„λ£λλ©΄ κ°€μƒν™κ²½μ„ ν™μ„±ν™”ν•λ‹¤:

#### Linux/Mac
```bash
source .venv/bin/activate
```

#### Windows (PowerShell)
```powershell
.venv\Scripts\Activate.ps1
```

#### Windows (CMD)
```cmd
.venv\Scripts\activate.bat
```

κ°€μƒν™κ²½μ΄ ν™μ„±ν™”λλ©΄ ν„°λ―Έλ„ ν”„λ΅¬ν”„νΈ μ•μ— `(.venv)`κ°€ ν‘μ‹λλ‹¤.

### 5. Jupyter Notebook μ‹¤ν–‰

κ°€μƒν™κ²½μ΄ ν™μ„±ν™”λ μƒνƒμ—μ„ Jupyter Notebookμ„ μ‹¤ν–‰ν•λ‹¤:

```bash
jupyter notebook
```

λλ” κ°€μƒν™κ²½ ν™μ„±ν™” μ—†μ΄ λ°”λ΅ μ‹¤ν–‰ν•  μλ„ μλ‹¤:
```bash
uv run jupyter notebook
```

λΈλΌμ°μ €κ°€ μλ™μΌλ΅ μ—΄λ¦¬λ©΄ `examples/pymc-gp-toy_model.ipynb` νμΌμ„ μ„ νƒν•μ—¬ μμ λ¥Ό μ‹¤ν–‰ν•  μ μλ‹¤.

## π“ ν”„λ΅μ νΈ κµ¬μ΅°

```
pymc-examples/
β”β”€β”€ README.md                    # ν”„λ΅μ νΈ μ„¤λ…μ„
β”β”€β”€ pyproject.toml              # ν”„λ΅μ νΈ μ„¤μ • λ° μμ΅΄μ„±
β”β”€β”€ uv.lock                     # μμ΅΄μ„± λ²„μ „ μ κΈ νμΌ
β”β”€β”€ examples/                   # μμ  λ…ΈνΈλ¶ ν΄λ”
β”‚   β””β”€β”€ pymc-gp-toy_model.ipynb # Gaussian Process μμ 
β””β”€β”€ dataset/                    # λ°μ΄ν„°μ…‹ ν΄λ”
    β”β”€β”€ datacomp_hourly.csv     # μ»΄ν“¨ν„° μ‹λ®¬λ μ΄μ… λ°μ΄ν„°
    β””β”€β”€ datafield_hourly.csv    # μ‹¤μ  κ΄€μΈ΅ λ°μ΄ν„°
```

## π“ μμ  μ†κ°

### Gaussian Process Toy Model (`pymc-gp-toy_model.ipynb`)

μ΄ μμ λ” PyMCλ¥Ό μ‚¬μ©ν• Gaussian Process κΈ°λ° Bayesian μ¶”λ΅ μ μ™„μ „ν• κµ¬ν„μ„ μ κ³µν•λ‹¤. μ»΄ν“¨ν„° μ‹λ®¬λ μ΄μ… λ°μ΄ν„°μ™€ μ‹¤μ  κ΄€μΈ΅ λ°μ΄ν„°λ¥Ό κ²°ν•©ν•μ—¬ λ¬Όλ¦¬μ  νλΌλ―Έν„°λ¥Ό μ¶”μ •ν•λ” λ°©λ²•μ„ λ‹¨κ³„λ³„λ΅ μ„¤λ…ν•λ‹¤.

#### π― μ£Όμ” λ©ν‘
- μ»΄ν“¨ν„° μ‹λ®¬λ μ΄μ… λ°μ΄ν„°μ™€ μ‹¤μ  κ΄€μΈ΅ λ°μ΄ν„°λ¥Ό ν†µν•©
- Gaussian Processλ¥Ό μ—λ®¬λ μ΄ν„°λ΅ ν™μ©
- λ¬Όλ¦¬μ  νλΌλ―Έν„°(κΈ°κΈ°λ°€λ„, μ΅°λ…λ°€λ„, COP)μ Bayesian μ¶”μ • λ° λ¶ν™•μ‹¤μ„± μ •λ‰ν™”

#### π“ λ°μ΄ν„° λ¨λΈ

μ‹¤μ  μΈ΅μ • λ°μ΄ν„° $z$λ” λ‹¤μκ³Ό κ°™μ΄ λ¨λΈλ§λλ‹¤:

$$z = \eta(\mathbf{x}, \boldsymbol{\theta}) + e$$

μ—¬κΈ°μ„:
- $\eta(\mathbf{x}, \boldsymbol{\theta})$: μ‹¤μ  λ¬Όλ¦¬ ν”„λ΅μ„Έμ¤ λλ” μ»΄ν“¨ν„° μ‹λ®¬λ μ΄μ… ν•¨μ
- $\mathbf{x}$: μ…λ ¥ λ³€μ (μ™ΈκΈ°μ¨λ„, μƒλ€μµλ„)
- $\boldsymbol{\theta}$: λ¨λΈ νλΌλ―Έν„° (κΈ°κΈ°λ°€λ„, μ΅°λ…λ°€λ„, COP)
- $e$: κ΄€μΈ΅ μ¤μ°¨ (λλ¤ λ…Έμ΄μ¦)

#### π”¬ λ°μ΄ν„° νƒ€μ…

**1. μ»΄ν“¨ν„° μ‹λ®¬λ μ΄μ… λ°μ΄ν„° (`datacomp_hourly.csv`)**
- ν•νƒ: `(yc, xc1, xc2, tc1, tc2, tc3)`
- `yc`: μ—λ„μ§€ μ‚¬μ©λ‰ (μ‹λ®¬λ μ΄μ… μ¶λ ¥κ°’)
- `xc1`: μ™ΈκΈ°μ¨λ„ (μ²« λ²μ§Έ μ…λ ¥ λ³€μ)
- `xc2`: μƒλ€μµλ„ (λ‘ λ²μ§Έ μ…λ ¥ λ³€μ)
- `tc1`: κΈ°κΈ°λ°€λ„ (μ¶”μ • λ€μƒ νλΌλ―Έν„°)
- `tc2`: μ΅°λ…λ°€λ„ (μ¶”μ • λ€μƒ νλΌλ―Έν„°)
- `tc3`: COP - Coefficient of Performance (μ¶”μ • λ€μƒ νλΌλ―Έν„°)

**2. μ‹¤μ  κ΄€μΈ΅ λ°μ΄ν„° (`datafield_hourly.csv`)**
- ν•νƒ: `(yf, xf1, xf2)`
- `yf`: μ—λ„μ§€ μ‚¬μ©λ‰ (μ‹¤μ  μΈ΅μ •κ°’)
- `xf1`: μ™ΈκΈ°μ¨λ„ (μ²« λ²μ§Έ μ…λ ¥ λ³€μ)
- `xf2`: μƒλ€μµλ„ (λ‘ λ²μ§Έ μ…λ ¥ λ³€μ)
- λ¬Όλ¦¬μ  νλΌλ―Έν„° `tc1, tc2, tc3`λ” λ―Έμ§€μλ΅ Bayesian μ¶”λ΅ μ„ ν†µν•΄ μ¶”μ •

## π§® κΈ°μ μ  λ°°κ²½

### Bayesian Model Calibration

μ΄ μμ λ” Kennedy and O'Hagan (2001)μ Bayesian Model Calibration λ°©λ²•λ΅ μ„ κΈ°λ°μΌλ΅ ν•λ‹¤:

1. **μ™„λ²½ν• λ¨λΈ κ°€μ •**: μ»΄ν“¨ν„° λ¨λΈμ΄ μ‹¤μ  λ¬Όλ¦¬ ν”„λ΅μ„Έμ¤λ¥Ό μ™„λ²½ν•κ² μ¬ν„ν•λ‹¤κ³  κ°€μ •
2. **Gaussian Process μ—λ®¬λ μ΄μ…**: λ³µμ΅ν• μ‹λ®¬λ μ΄μ… ν•¨μλ¥Ό GPλ΅ κ·Όμ‚¬
3. **ν†µν•©λ μ¶”λ΅ **: μ‹λ®¬λ μ΄μ…κ³Ό κ΄€μΈ΅ λ°μ΄ν„°λ¥Ό ν•λ‚μ λ¨λΈλ΅ ν†µν•©

### Gaussian Process λ¨λΈλ§

**μ»¤λ„ ν•¨μ**: Exponential Quadratic (RBF) μ»¤λ„ μ‚¬μ©

$$k(x_i, x_j) = \eta^2 \exp\left(-\frac{1}{2}\sum_{d=1}^{5}\frac{(x_{i,d} - x_{j,d})^2}{l_d^2}\right)$$

**ν•μ΄νΌνλΌλ―Έν„°**:
- `l`: Length-scale νλΌλ―Έν„° (κ° μ…λ ¥ μ°¨μ›μ—μ„μ ν•¨μ λ³€λ™μ„±)
- `eta`: Amplitude νλΌλ―Έν„° (ν•¨μ κ°’μ μ „μ²΄μ μΈ λ³€λ™ ν­)
- `sigma`: κ΄€μΈ΅ λ…Έμ΄μ¦μ ν‘μ¤€νΈμ°¨

### MCMC μƒν”λ§

**NUTS (No-U-Turn Sampler)** μ‚¬μ©:
- Hamiltonian Monte Carloμ κ°μ„ λ λ²„μ „
- μλ™ νλ‹κ³Ό ν¨μ¨μ μΈ μλ ΄
- NumPyro λ°±μ—”λ“λ΅ λΉ λ¥Έ μ„±λ¥ μ κ³µ

## π’» μ‚¬μ©λ²•

### 1. λ…ΈνΈλ¶ μ‹¤ν–‰
```bash
# Jupyter Notebookμ—μ„ μμ  νμΌ μ—΄κΈ°
jupyter notebook examples/pymc-gp-toy_model.ipynb
```

### 2. λ‹¨κ³„λ³„ μ‹¤ν–‰

λ…ΈνΈλ¶μ€ λ‹¤μκ³Ό κ°™μ€ λ‹¨κ³„λ΅ κµ¬μ„±λμ–΄ μλ‹¤:

1. **λΌμ΄λΈλ¬λ¦¬ μ„ν¬νΈ λ° ν™κ²½ μ„¤μ •**
   - PyMC, NumPy, ArviZ λ“± ν•„μ λΌμ΄λΈλ¬λ¦¬ μ„ν¬νΈ
   - κ° λΌμ΄λΈλ¬λ¦¬μ μ—­ν• κ³Ό μ‚¬μ© λ©μ  μ„¤λ…

2. **λ°μ΄ν„° μ„ν¬νΈ λ° νƒμƒ‰μ  λ¶„μ„**
   - μ»΄ν“¨ν„° μ‹λ®¬λ μ΄μ… λ°μ΄ν„°μ™€ μ‹¤μ  κ΄€μΈ΅ λ°μ΄ν„° λ΅λ“
   - λ°μ΄ν„° κµ¬μ΅° ν™•μΈ λ° κΈ°λ³Έ ν†µκ³„λ‰ λ¶„μ„

3. **λ°μ΄ν„° μ‹κ°ν™” λ° νƒμƒ‰μ  λ¶„μ„**
   - μ‹¤μ  κ΄€μΈ΅ λ°μ΄ν„°μ 2μ°¨μ› κ³µκ°„ λ¶„ν¬ μ‹κ°ν™”
   - λ“±κ³ μ„  ν”λ΅―μ„ ν†µν• μ—λ„μ§€ μ†λΉ„ ν¨ν„΄ νμ•…

4. **Bayesian Inference λ¨λΈ μ •μ**
   - λ°μ΄ν„° μ •κ·ν™” (Min-Max Scaling)
   - GP μ»¤λ„ λ° ν•μ΄νΌνλΌλ―Έν„° μ •μ
   - Marginal GPλ¥Ό ν™μ©ν• ν¨μ¨μ μΈ λ¨λΈ κµ¬μ„±

5. **MCMC μƒν”λ§ μν–‰**
   - NUTS μƒν”λ¬λ΅ μ‚¬ν›„ λ¶„ν¬ κ·Όμ‚¬
   - μƒν”λ§ νλΌλ―Έν„° μ„¤μ • λ° μλ ΄μ„± ν™•μΈ

6. **μ‚¬ν›„ λ¶„ν¬ λ¶„μ„ λ° μ‹κ°ν™”**
   - Trace plotμΌλ΅ MCMC μλ ΄μ„± μ§„λ‹¨
   - Length-scale ν•΄μ„μ„ ν†µν• λ³€μ μ¤‘μ”λ„ λ¶„μ„
   - Pair plotμΌλ΅ νλΌλ―Έν„° κ°„ μƒκ΄€κ΄€κ³„ λ¶„μ„

7. **μ‚¬ν›„ μμΈ΅ λ¶„ν¬ (Posterior Predictive Distribution)**
   - μƒλ΅μ΄ μ„μΉμ—μ„μ μμΈ΅ μν–‰
   - 95% μ‹ λΆ°κµ¬κ°„κ³Ό μμΈ΅ ν‰κ·  μ‹κ°ν™”

### 3. κ²°κ³Ό ν•΄μ„

#### νλΌλ―Έν„° μ¶”μ • κ²°κ³Ό
- `theta_true[0]`: κΈ°κΈ°λ°€λ„ (Equipment Density)
- `theta_true[1]`: μ΅°λ…λ°€λ„ (Lighting Density)  
- `theta_true[2]`: COP (Coefficient of Performance)

#### Length-scale ν•΄μ„
- **ν° length-scale**: ν•΄λ‹Ή μ°¨μ›μ—μ„ μ…λ ¥ λ³€ν™”μ— λ€ν• μ¶λ ¥ λ³€ν™”κ°€ μ‘μ (λ‚®μ€ λ―Όκ°λ„)
- **μ‘μ€ length-scale**: ν•΄λ‹Ή μ°¨μ›μ΄ μ¶λ ¥μ— ν° μν–¥μ„ λ―ΈμΉ¨ (λ†’μ€ λ―Όκ°λ„)

μμ μ—μ„λ” κ³µκ°„ λ³€μ(μ™ΈκΈ°μ¨λ„, μƒλ€μµλ„)μ length-scaleμ΄ νλΌλ―Έν„°λ³΄λ‹¤ μ‘μ€ κ²½ν–¥μ„ λ³΄μ΄λ”λ°, μ΄λ” μ¨λ„μ™€ μµλ„κ°€ μ—λ„μ§€ μ†λΉ„λ‰μ— λ” ν° μν–¥μ„ λ―ΈμΉλ‹¤λ” κ²ƒμ„ μλ―Έν•λ‹¤.

## π“ μ£Όμ” κ°λ… μ„¤λ…

### 1. λ°μ΄ν„° μ •κ·ν™” (Data Normalization)

**μ™ ν•„μ”ν•κ°€?**
- Gaussian Process λ¨λΈλ§μ—μ„ μμΉμ  μ•μ •μ„± ν™•λ³΄
- μ„λ΅ λ‹¤λ¥Έ μ¤μΌ€μΌμ λ³€μλ“¤μ„ κ³µμ •ν•κ² λΉ„κµ
- MCMC μƒν”λ§μ μλ ΄ μ†λ„ ν–¥μƒ

**Min-Max Scaling κ³µμ‹:**
$$x_{normalized} = \frac{x - x_{min}}{x_{max} - x_{min}}$$

λ¨λ“  λ°μ΄ν„°λ¥Ό [0, 1] λ²”μ„λ΅ λ³€ν™ν•μ—¬ λ™μΌν• μ¤μΌ€μΌμ—μ„ μ²λ¦¬ν•λ‹¤.

### 2. Marginal Gaussian Process

**Latent GP vs Marginal GP**

- **Latent GP**: GPμ—μ„ ν•¨μκ°’ $\mathbf{f}$λ¥Ό λ¨Όμ € μƒν”λ§ν• ν›„ κ΄€μΈ΅κ°’ μμΈ΅
- **Marginal GP**: μ¤‘κ°„ λ³€μ $\mathbf{f}$λ¥Ό μ λ¶„μΌλ΅ μ κ±°ν•μ—¬ μ§μ ‘ κ΄€μΈ΅κ°’ λ¨λΈλ§

**μ¥μ :**
- κ³„μ‚° ν¨μ¨μ„± ν–¥μƒ (μ°¨μ› μ¶•μ†)
- μμΉμ  μ•μ •μ„± μ¦κ°€
- μ •κ·λ¶„ν¬ λ…Έμ΄μ¦ κ°€μ • ν•μ—μ„ ν•΄μ„μ  marginal likelihood κ³„μ‚° κ°€λ¥

### 3. MCMCμ™€ NUTS

**MCMC (Markov Chain Monte Carlo)**λ€?
- λ³µμ΅ν• λ‹¤μ°¨μ› μ‚¬ν›„ λ¶„ν¬μ—μ„ μƒν”μ„ μƒμ„±ν•λ” μ•κ³ λ¦¬μ¦
- μ§μ ‘ κ³„μ‚°μ΄ μ–΄λ ¤μ΄ ν™•λ¥  λ¶„ν¬λ¥Ό κ·Όμ‚¬

**NUTS (No-U-Turn Sampler)**μ νΉμ§•:
- Hamiltonian Monte Carloμ κ°μ„  λ²„μ „
- Step sizeμ™€ integration timeμ„ μλ™μΌλ΅ μ΅°μ •
- λ‹¤λ¥Έ MCMC λ°©λ²•λ³΄λ‹¤ λΉ λ¥΄κ³  ν¨μ¨μ μΈ μλ ΄

**μ£Όμ” νλΌλ―Έν„°:**
- `draws`: μ‹¤μ  μƒν”λ§ν•  κ°μ (μ‚¬ν›„ λ¶„ν¬ κ·Όμ‚¬μ©)
- `tune`: μ›λ°μ—… λ‹¨κ³„ κΈΈμ΄ (μƒν”λ¬ νλΌλ―Έν„° νλ‹)
- `chains`: λ…λ¦½μ μΈ μƒν”λ§ μ²΄μΈ μ (μλ ΄μ„± μ§„λ‹¨μ©)
- `target_accept`: λ©ν‘ μλ½λ¥  (0.8-0.95 κ¶μ¥)

### 4. μ‚¬ν›„ λ¶„ν¬ μ§„λ‹¨

**Trace Plot**: 
- μ™Όμ½: μ‚¬ν›„ λ¶„ν¬ νμ¤ν† κ·Έλ¨
- μ¤λ¥Έμ½: MCMC μƒν”λ§ κ³Όμ •μ—μ„μ νλΌλ―Έν„° κ°’ λ³€ν™”
- μλ ΄ν• κ²½μ°: μ¤λ¥Έμ½ κ·Έλν”„κ°€ μ•μ •μ μΈ λλ¤ μ›ν¬ ν•νƒ

**Pair Plot**:
- λ€κ°μ„ : κ° νλΌλ―Έν„°μ μ£Όλ³€ λ¶„ν¬
- λΉ„λ€κ°μ„ : νλΌλ―Έν„° μ κ°„μ κ²°ν•© λ¶„ν¬
- νλΌλ―Έν„° κ°„ μƒκ΄€κ΄€κ³„μ™€ λ¶ν™•μ‹¤μ„± κµ¬μ΅° νμ•…

## π“¦ μμ΅΄μ„±

### ν•µμ‹¬ λΌμ΄λΈλ¬λ¦¬

- **`pymc`**: Bayesian ν†µκ³„ λ¨λΈλ§κ³Ό MCMC μ¶”λ΅ 
  - ν™•λ¥ μ  ν”„λ΅κ·Έλλ° ν”„λ μ„μ›ν¬
  - Gaussian Process λ¨λΈλ§ μ§€μ›
  - λ‹¤μ–‘ν• MCMC μƒν”λ¬ μ κ³µ

- **`numpy`**: μμΉ μ—°μ‚°κ³Ό λ‹¤μ°¨μ› λ°°μ—΄ μ²λ¦¬
  - κΈ°λ³Έμ μΈ μν•™ μ—°μ‚° λ° μ„ ν•λ€μ
  - λ°μ΄ν„° μƒμ„±, λ³€ν™, ν†µκ³„ κ³„μ‚°

- **`arviz`**: Bayesian λ¶„μ„ κ²°κ³Ό μ”μ•½ λ° μ‹κ°ν™”
  - MCMC μ²΄μΈ μ§„λ‹¨ λ° μλ ΄μ„± κ²€μ‚¬
  - Trace plot, posterior plot λ“± μ‹κ°ν™” λ„κµ¬

- **`pandas`**: ν‘ ν•μ‹ λ°μ΄ν„° μ²λ¦¬
  - CSV νμΌ μ½κΈ°/μ“°κΈ°
  - λ°μ΄ν„°ν”„λ μ„ μ΅°μ‘ λ° μ „μ²λ¦¬

- **`matplotlib`**: λ°μ΄ν„° μ‹κ°ν™”
  - 2D ν”λ΅― μƒμ„± λ° μ»¤μ¤ν„°λ§μ΄μ§•
  - κ²°κ³Ό μ‹κ°ν™” λ° λ¶„μ„ λ„ν‘ μ‘μ„±

- **`pytensor`**: ν…μ„ μ—°μ‚° μ§€μ› (PyMC λ°±μ—”λ“)
  - μ‹¬λ³Όλ¦­ ν…μ„ μ—°μ‚° λΌμ΄λΈλ¬λ¦¬
  - μλ™ λ―Έλ¶„ λ° κ·Έλλ””μ–ΈνΈ κ³„μ‚°
  - PyMC λ‚΄λ¶€ μ—°μ‚°μ— μ‚¬μ©

### μ¶”κ°€ λΌμ΄λΈλ¬λ¦¬

- **`jupyter`**: λ…ΈνΈλ¶ ν™κ²½
- **`numpyro`**: NUTS μƒν”λ¬ λ°±μ—”λ“ (λΉ λ¥Έ μ„±λ¥)

## π”§ κ³ κΈ‰ μ„¤μ •

### λ‹¤μ¤‘ μ²΄μΈ μƒν”λ§ (κ¶μ¥)

λ‹¨μΌ μ²΄μΈλ³΄λ‹¤λ” μ—¬λ¬ μ²΄μΈμ„ λ™μ‹μ— μ‹¤ν–‰ν•λ” κ²ƒμ΄ μλ ΄μ„± μ§„λ‹¨μ— μ λ¦¬ν•λ‹¤:

```python
trace = pm.sample(
    draws=1000,
    tune=1000,
    chains=4,        # 4κ° μ²΄μΈμΌλ΅ λ³‘λ ¬ μƒν”λ§
    cores=4,         # 4κ° μ½”μ–΄ μ‚¬μ©
    target_accept=0.8
)
```

**μ¥μ :**
- $\hat{R}$ (R-hat) ν†µκ³„λ‰μΌλ΅ μλ ΄μ„± μ§„λ‹¨ κ°€λ¥
- Effective Sample Size (ESS) μ •ν™•ν• κ³„μ‚°
- μλ ΄ μ‹¤ν¨ μ΅°κΈ° λ°κ²¬

### μλ ΄μ„± μ§„λ‹¨

**μ£Όμ” μ§€ν‘:**
1. **Trace plot**: μ‹κ°μ μΌλ΅ μλ ΄ μ—¬λ¶€ ν™•μΈ
2. **$\hat{R}$ (R-hat)**: 1.01 μ΄ν•λ©΄ μλ ΄ (chainμ΄ 2κ° μ΄μƒμΌ λ•)
3. **ESS (Effective Sample Size)**: λ…λ¦½μ μΈ μƒν” κ°μ (ν΄μλ΅ μΆ‹μ)
4. **Autocorrelation**: λ‚®μ„μλ΅ λ…λ¦½μ μΈ μƒν”

## π’΅ νκ³Ό μ£Όμμ‚¬ν•­

### μ΄μ‹¬μλ¥Ό μ„ν• ν

1. **λ°μ΄ν„° μ •κ·ν™” ν•„μ**: GP λ¨λΈλ§μ—μ„λ” λ¨λ“  λ³€μλ¥Ό λ™μΌν• μ¤μΌ€μΌλ΅ λ³€ν™ν•λ” κ²ƒμ΄ μ¤‘μ”ν•λ‹¤.

2. **μ›λ°μ—… λ‹¨κ³„μ μ¤‘μ”μ„±**: `tune` νλΌλ―Έν„°λ¥Ό μ¶©λ¶„ν ν¬κ² μ„¤μ •ν•΄μ•Ό μƒν”λ¬κ°€ μµμ μ νλΌλ―Έν„°λ¥Ό μ°Ύλ”λ‹¤.

3. **λ‹¨μΌ μ²΄μΈμ ν•κ³„**: μ‹¤μ  λ¶„μ„μ—μ„λ” μµμ† 2κ° μ΄μƒμ μ²΄μΈμ„ μ‚¬μ©ν•΄μ•Ό μλ ΄μ„± μ§„λ‹¨μ΄ κ°€λ¥ν•λ‹¤.

4. **κ²°κ³Ό ν•΄μ„ μ‹ μ—­λ³€ν™**: μ •κ·ν™”λ νλΌλ―Έν„°λ¥Ό μ›λ λ¬Όλ¦¬μ  λ‹¨μ„λ΅ μ—­λ³€ν™ν•΄μ•Ό μλ―Έ μλ” ν•΄μ„μ΄ κ°€λ¥ν•λ‹¤.

### μ£Όμμ‚¬ν•­

1. **μλ ΄μ„± ν™•μΈ**: Trace plotμ—μ„ νλΌλ―Έν„° κ°’μ΄ μ•μ •μ μΌλ΅ λ³€ν™”ν•λ”μ§€ ν™•μΈν•λ‹¤.

2. **μƒν” ν¬κΈ°**: λ³µμ΅ν• λ¨λΈμΌμλ΅ λ” λ§μ€ μƒν”(`draws`)μ΄ ν•„μ”ν•λ‹¤.

3. **μ‚¬μ „ λ¶„ν¬ μ„ νƒ**: λ¬Όλ¦¬μ μΌλ΅ νƒ€λ‹Ήν• λ²”μ„λ¥Ό κ°€μ§€λ” μ‚¬μ „ λ¶„ν¬λ¥Ό μ„ νƒν•λ‹¤.

4. **κ³„μ‚° μ‹κ°„**: GP λ¨λΈμ€ λ°μ΄ν„° ν¬κΈ°μ μ„Έμ κ³±μ— λΉ„λ΅€ν•μ—¬ κ³„μ‚° μ‹κ°„μ΄ μ¦κ°€ν•λ‹¤.

## π“ μ°Έκ³  μλ£

- [PyMC κ³µμ‹ λ¬Έμ„](https://www.pymc.io/)
- [PyMC GP Marginal Implementation](https://www.pymc.io/projects/examples/en/latest/gaussian_processes/GP-Marginal.html)
- [ArviZ λ¬Έμ„](https://python.arviz.org/)
- [uv κ³µμ‹ λ¬Έμ„](https://docs.astral.sh/uv/)
- Kennedy, M. C., & O'Hagan, A. (2001). Bayesian calibration of computer models. *Journal of the Royal Statistical Society: Series B*, 63(3), 425-464.
